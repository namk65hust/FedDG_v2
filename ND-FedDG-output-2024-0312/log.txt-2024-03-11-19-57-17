***************
** Arguments **
***************
backbone: 
config_file: configs/trainers/dg/vanilla/pacs.yaml
dataset_config_file: configs/datasets/dg/pacs_cs.yaml
eval_only: False
head: 
load_epoch: None
model_dir: 
no_train: False
option: 
opts: []
output_dir: output/dg/pacs/conststyle/art_painting
pos: []
resume: false
root: ./DATA
seed: 42
source_domains: ['cartoon', 'photo', 'sketch']
target_domains: ['art_painting']
tracker: <wandb.sdk.wandb_run.Run object at 0x7fe39d1f9250>
trainer: ConstStyleTrainer
transforms: None
uncertainty: 0.5
update_interval: 20
wandb: 1
************
** Config **
************
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  TEST:
    BATCH_SIZE: 128
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 64
    N_DOMAIN: 0
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: PACS
  NUM_LABELED: 250
  ROOT: ./DATA
  SOURCE_DOMAINS: ['cartoon', 'photo', 'sketch']
  STL10_FOLD: -1
  TARGET_DOMAINS: ['art_painting']
  VAL_PERCENT: 0.1
INPUT:
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GN_MEAN: 0.0
  GN_STD: 0.15
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 0.225]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  SIZE: (224, 224)
  TRANSFORMS: ('random_flip', 'random_translation', 'normalize')
LOG:
  TRACKER: None
  WANDB: 0
MODEL:
  BACKBONE:
    NAME: cresnet18
    PERTUBATION: 1
    POS: []
    PRETRAINED: True
    UNCERTAINTY: 0.0
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
  POS: []
  UNCERTAINTY: 0.5
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.99
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.001
  LR_SCHEDULER: cosine
  MAX_EPOCH: 50
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (10,)
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/dg/pacs/conststyle/art_painting
RESUME: false
SEED: 42
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  EVAL_FREQ: 1
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 10
TRAINER:
  CG:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEA:
    EMA_ALPHA: 0.999
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: ConstStyleTrainer
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBOSE: True
VERSION: 1
Loading trainer: ConstStyleTrainer
Loading dataset: PACS
Building transform_train
+ resize to 224x224
+ random flip
+ random translation
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
Building transform_test
+ resize to 224x224
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
***** Dataset statistics *****
  Dataset: PACS
  Source domains: ['cartoon', 'photo', 'sketch']
  Target domains: ['art_painting']
  # classes: 7
  # train_x: 7,136
  # val: 806
  # test: 2,048
Building model
Backbone: cresnet18
Backbone: cresnet18
Loading evaluator: Classification
No checkpoint found, train from scratch
Initializing summary writer for tensorboard with log_dir=output/dg/pacs/conststyle/art_painting
epoch [1/50][10/111]	time 0.055 (0.299)	data 0.000 (0.086)	eta 0:27:36	loss 1.7886 (2.0203)	accuracy 25.0000 (21.0938)	lr 0.001
epoch [1/50][20/111]	time 0.055 (0.178)	data 0.000 (0.043)	eta 0:16:22	loss 1.5054 (1.8209)	accuracy 48.4375 (30.0000)	lr 0.001
epoch [1/50][30/111]	time 0.056 (0.137)	data 0.000 (0.029)	eta 0:12:36	loss 1.0997 (1.6211)	accuracy 70.3125 (41.0938)	lr 0.001
epoch [1/50][40/111]	time 0.058 (0.117)	data 0.001 (0.022)	eta 0:10:42	loss 0.9749 (1.4637)	accuracy 65.6250 (48.8281)	lr 0.001
epoch [1/50][50/111]	time 0.053 (0.104)	data 0.000 (0.018)	eta 0:09:33	loss 0.8728 (1.3438)	accuracy 78.1250 (54.0938)	lr 0.001
epoch [1/50][60/111]	time 0.057 (0.096)	data 0.001 (0.015)	eta 0:08:47	loss 0.6068 (1.2377)	accuracy 85.9375 (58.7500)	lr 0.001
epoch [1/50][70/111]	time 0.053 (0.090)	data 0.000 (0.013)	eta 0:08:14	loss 0.5900 (1.1525)	accuracy 82.8125 (62.1429)	lr 0.001
epoch [1/50][80/111]	time 0.056 (0.086)	data 0.001 (0.011)	eta 0:07:49	loss 0.5604 (1.0821)	accuracy 87.5000 (64.7852)	lr 0.001
epoch [1/50][90/111]	time 0.054 (0.082)	data 0.000 (0.010)	eta 0:07:30	loss 0.4919 (1.0196)	accuracy 90.6250 (67.1007)	lr 0.001
epoch [1/50][100/111]	time 0.055 (0.080)	data 0.000 (0.009)	eta 0:07:14	loss 0.4682 (0.9633)	accuracy 90.6250 (69.1875)	lr 0.001
epoch [1/50][110/111]	time 0.051 (0.077)	data 0.000 (0.008)	eta 0:07:00	loss 0.6079 (0.9182)	accuracy 78.1250 (70.8097)	lr 0.001
Do evaluation on test set
=> result
* total: 2,048
* correct: 1,252
* current accuracy: 61.13%
* best accuracy: 61.13%
* error: 38.87%
Get samples belong to cluster 0
Cluster 0 has 1963 samples
Get samples belong to cluster 1
Cluster 1 has 1628 samples
Get samples belong to cluster 2
Cluster 2 has 3513 samples
Mean log likelihood of cluster 0 is 372.4391219397135
Mean log likelihood of cluster 1 is 394.08904140866923
Mean log likelihood of cluster 2 is 474.83220693885215
Layer 0 chooses cluster 2 with log likelihood score 474.83220693885215
